@model DentalManagement.Areas.Doctor.Models.DoctorDashboardViewModel
@{
    ViewData["Title"] = "Doctor Dashboard";
}

<div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800">Dashboard</h1>
    <a asp-area="Doctor" asp-controller="TimeSlots" asp-action="Calendar" class="d-none d-sm-inline-block btn btn-primary shadow-sm">
        <i class="bi bi-calendar3 me-1"></i> Full Calendar View
    </a>
</div>

@if (!string.IsNullOrEmpty(ViewBag.ErrorMessage))
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        @ViewBag.ErrorMessage
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<div class="row mb-4">
    <div class="col-xl-3 col-lg-4 col-md-12">
        <div class="card shadow h-100">
            <div class="card-header py-3 bg-primary text-white d-flex align-items-center">
                <i class="bi bi-person-circle me-2"></i>
                <h6 class="m-0 font-weight-bold">My Profile</h6>
            </div>
            <div class="card-body">
                @if (Model.CurrentDoctor != null)
                {
                    <div class="text-center mb-3">
                        @if (!string.IsNullOrEmpty(Model.CurrentDoctor.ProfilePictureUrl))
                        {
                            <img src="@Model.CurrentDoctor.ProfilePictureUrl" alt="Profile Picture" class="rounded-circle img-thumbnail" style="width: 120px; height: 120px; object-fit: cover;">
                        }
                        else
                        {
                            <div class="profile-initials rounded-circle mx-auto" style="width: 120px; height: 120px; background-color: #0d6efd; color: white; display: flex; align-items: center; justify-content: center; font-size: 2.5rem;">
                                @(Model.CurrentDoctor.FirstName[0].ToString() + Model.CurrentDoctor.LastName[0].ToString())
                            </div>
                        }
                        <h4 class="mt-3">Dr. @Model.CurrentDoctor.FirstName @Model.CurrentDoctor.LastName</h4>
                        <p class="text-muted">@Model.CurrentDoctor.Specialty</p>
                    </div>
                    <div class="card mb-3 bg-light">
                        <div class="card-body p-3">
                            <h6 class="card-subtitle mb-2 text-muted">Contact Information</h6>
                            <p class="mb-1"><i class="bi bi-envelope me-2"></i>@Model.CurrentDoctor.User?.Email</p>
                            <p class="mb-0"><i class="bi bi-telephone me-2"></i>@Model.CurrentDoctor.PhoneNumber</p>
                        </div>
                    </div>
                    <div class="d-grid">
                        <a asp-area="Doctor" asp-controller="Profile" asp-action="Index" class="btn btn-outline-primary">Edit Profile</a>
                    </div>
                }
                else
                {
                    <div class="text-center">
                        <p class="text-muted">Profile information not available.</p>
                    </div>
                }
            </div>
        </div>
    </div>
    <div class="col-xl-9 col-lg-8 col-md-12">
        <div class="row">
            <!-- Time Slots Card -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card dashboard-card border-0 h-100 bg-gradient-primary text-white">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="card-title text-uppercase">Time Slots</div>
                                <div class="count">@Model.TimeSlotCount</div>
                            </div>
                            <div class="col-auto">
                                <i class="bi bi-clock icon"></i>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent border-0">
                        <a asp-area="Doctor" asp-controller="TimeSlots" asp-action="Index" class="text-white small stretched-link">View Details <i class="bi bi-arrow-right"></i></a>
                    </div>
                </div>
            </div>

            <!-- Treatments Card -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card dashboard-card border-0 h-100 bg-gradient-success text-white">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="card-title text-uppercase">Treatments</div>
                                <div class="count">@Model.TreatmentCount</div>
                            </div>
                            <div class="col-auto">
                                <i class="bi bi-clipboard2-pulse icon"></i>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent border-0">
                        <a asp-area="Doctor" asp-controller="Treatments" asp-action="Index" class="text-white small stretched-link">View Details <i class="bi bi-arrow-right"></i></a>
                    </div>
                </div>
            </div>
            
            <!-- Appointments Card -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card dashboard-card border-0 h-100 bg-gradient-info text-white">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="card-title text-uppercase">Appointments</div>
                                <div class="count">@Model.AppointmentCount</div>
                            </div>
                            <div class="col-auto">
                                <i class="bi bi-calendar-check icon"></i>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent border-0">
                        <a asp-area="Doctor" asp-controller="Appointments" asp-action="Index" class="text-white small stretched-link">View Details <i class="bi bi-arrow-right"></i></a>
                    </div>
                </div>
            </div>

            <!-- Patients Card -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card dashboard-card border-0 h-100 bg-gradient-warning text-white">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="card-title text-uppercase">Patients</div>
                                <div class="count">@Model.PatientCount</div>
                            </div>
                            <div class="col-auto">
                                <i class="bi bi-people icon"></i>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent border-0">
                        <a asp-area="Doctor" asp-controller="Patients" asp-action="Index" class="text-white small stretched-link">View Details <i class="bi bi-arrow-right"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Time Slots Calendar Link Card -->
<div class="card shadow mb-4">
    <div class="card-header py-3 d-flex justify-content-between align-items-center bg-primary text-white">
        <div class="d-flex align-items-center">
            <i class="bi bi-calendar3 me-2"></i>
            <h6 class="m-0 font-weight-bold">My Schedule</h6>
        </div>
    </div>
    <div class="card-body">
        <div class="text-center py-4">
            <i class="bi bi-calendar-week text-primary" style="font-size: 4rem;"></i>
            <p class="lead mt-3 mb-2">View your complete schedule in the calendar</p>
            <p class="text-muted mb-4">Check your availability and booked appointments in a visual calendar view</p>
            <a asp-area="Doctor" asp-controller="TimeSlots" asp-action="Calendar" class="btn btn-primary px-4 py-2">
                <i class="bi bi-calendar3 me-2"></i> Go to Calendar View
            </a>
        </div>
    </div>
</div>

@section Styles {
    <style>
        /* Enhanced styles for dashboard */
        .dashboard-card {
            transition: transform 0.2s;
            box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15) !important;
        }
        
        .dashboard-card:hover {
            transform: translateY(-3px);
        }
        
        .dashboard-card .icon {
            font-size: 2rem;
            opacity: 0.8;
        }
        
        .dashboard-card .count {
            font-size: 2.2rem;
            font-weight: 700;
            margin-top: 5px;
        }
        
        .dashboard-card .card-title {
            font-size: 0.85rem;
            font-weight: 600;
            letter-spacing: 0.1rem;
        }
        
        /* Badge styles */
        .badge {
            font-weight: 500;
        }
        
        /* Button styles */
        .btn {
            box-shadow: none;
        }
    </style>
}

@section Scripts {
    <script>
        // Auto-dismiss alerts after 5 seconds
        setTimeout(function() {
            $('.alert').alert('close');
        }, 5000);
    </script>
} 